' Gambas class file

R As Integer
G As Integer
B As Integer
R2 As Integer
G2 As Integer
B2 As Integer
Coln As Boolean
Inherits PdfWriter

Public Sub _new()

  R = Start.R
  G = Start.G
  B = Start.B
  R2 = Start.R2
  G2 = Start.G2
  B2 = Start.B2
  If R2 = 0 Then
    R2 = R
    G2 = G
    B2 = B
  Endif

End

'********************************* Impressions des bons de préparation ******************************
'Lignes continues
Public Sub Lines(PosY As String)

  Me.SetXY(7, PosY)
  Me.SetLineWidth(0.1)
  Me.Line(0, PosY, 302, PosY)

End
'---------------------------- Entete  ----------------------------------------

Public Sub Entete(ent As String)

  Me.AddPage
  Me.SetXY(6, 8)
  Me.SetFont("Helvetica", "B", 10)
  Me.cell(120, 8, ent, "", 0, "L", False)

End

Public Sub Entete2(numero As String)

  Me.SetFont("Helvetica", "B", 10)
  Me.SetXY(120, 8)
  Me.cell(120, 8, "Bon de préparation", " ", 0, "L", False)
  Me.SetXY(120, 12)
  Me.cell(120, 8, numero, "", 0, "L", False)

End

Public Sub cadre()

  Me.SetLineWidth(0.1)
  Me.Line(6, 26, 80, 26)
  Me.Line(6, 60, 80, 60)
  Me.Line(6, 26, 6, 60)
  Me.Line(80, 26, 80, 60)
  Me.Line(120, 26, 200, 26)
  Me.Line(120, 26, 120, 60)
  Me.Line(200, 26, 200, 60)
  Me.Line(120, 60, 200, 60)

End

Public Sub adresse(intitule As String, adr1 As String, adr2 As String, burdist As String, tel As String, tel3 As String, fax As String, mel As String)

  Me.SetXY(8, 20)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(20, 5, "Coordonnées client", " ", 0, " L ", False)
  Me.SetXY(8, 26)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(20, 5, intitule, "", 0, "L", False)
  Me.SetXY(8, 30)
  Me.cell(20, 5, adr1, "", 0, "L", False)
  Me.SetXY(8, 34)
  Me.cell(20, 5, adr2, "", 0, "L", False)
  Me.SetXY(8, 38)
  Me.cell(20, 5, burdist, "", 0, "L", False)
  Me.SetXY(8, 42)
  Me.cell(20, 5, tel, "", 0, "L", False)
  Me.SetXY(8, 46)
  Me.cell(20, 5, tel3, "", 0, "L", False)
  Me.SetXY(8, 50)
  Me.cell(20, 5, fax, "", 0, "L", False)
  Me.SetXY(8, 54)
  Me.cell(20, 5, mel, "", 0, "L", False)

End

Public Sub adresse2(intitule As String, adr1 As String, adr2 As String, burdist As String)

  Me.SetFont("Helvetica", "", 10)
  Me.SetXY(122, 20)
  Me.cell(20, 5, "Adresse de livraison", " ", 0, " L ", False)
  Me.SetXY(122, 32)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(20, 5, intitule, "", 0, "L", False)
  Me.SetXY(122, 37)
  Me.cell(20, 5, adr1, "", 0, "L", False)
  Me.SetXY(122, 42)
  Me.cell(20, 5, adr2, "", 0, "L", False)
  Me.SetXY(122, 47)
  Me.cell(20, 5, burdist, "", 0, "L", False)

End

'Entete des lignes de detail
Public Sub Level1()

  Me.SetXY(4, 80)
  Me.SetFont("Helvetica", "", 8)
  Me.SetFillColor(R, G, B)
  Me.cell(30, 5, "Référence", True, 0, "C", True)
  Me.cell(10, 5, "Casier", True, 0, "C", True)
  Me.cell(20, 5, "Fournisseur", True, 0, "C", True)
  Me.cell(76, 5, "Intitulé", True, 0, "C", True)
  Me.cell(16, 5, "Qté C", True, 0, "C", True)
  Me.cell(16, 5, "Qté R", True, 0, "C", True)
  Me.cell(16, 5, "Reçue", True, 0, "C", True)
  Me.cell(16, 5, "Reliquat", True, 0, "C", True)

End

Public Sub Level2(code As String, casier As String, fournisseur As String, intitule As String, qtec As String, qter As String, PosY As Integer, i As Integer)

  Me.SetXY(4, PosY)
  Me.SetFont("Helvetica", "", 8)
  If i Mod 2 = 0 Then
    Me.SetFillColor(223, 223, 223)
  Else
    Me.SetFillColor(255, 255, 255)
  Endif
  Me.cell(30, 5, code, False, 0, "L", True)
  'Me.SetFont("Helvetica", "", 6)
  Me.cell(10, 5, casier, False, 0, "L", True)
  'Me.SetFont("Helvetica", "", 8)
  Me.cell(20, 5, fournisseur, False, 0, "C", True)
  Me.cell(76, 5, intitule, False, 0, "L", True)
  Me.cell(16, 5, qtec, False, 0, "R", True)
  Me.cell(16, 5, qter, False, 0, "R", True)

End

Public Sub carre(posy As Integer)
  ' premier carré

  Me.SetLineWidth(0.1)
  Me.Line(180, Posy, 184, posy)
  Me.Line(180, posy, 180, posy + 4)
  Me.Line(184, posy, 184, posy + 4)
  Me.Line(180, posy + 4, 184, posy + 4)
  'deuxieme carré
  Me.Line(194, Posy, 198, posy)
  Me.Line(194, posy, 194, posy + 4)
  Me.Line(198, posy, 198, posy + 4)
  Me.Line(194, posy + 4, 198, posy + 4)

End

'Total
Public Sub Level3(total As String, Posy As Integer)

  Me.SetXY(136, PosY)
  Me.SetFont("Helvetica", "B", 10)
  Me.cell(66, 5, "Total du bon de préparation : " & total, True, 0, "L", True)

End

'Bas de page
Public Sub Basep()

  Me.SetXY(4, -20)
  Me.SetFont("Helvetica", "", 10)
  Me.Cell(50, 5, "Reliquat de la commande N° : ", False, 0, "C", False)
  Me.Cell(60, 5, "Nom expéditeur : ", False, 0, "C", False)
  Me.Cell(40, 5, "Numéro colis : ", False, 0, "C", False)
  Me.Cell(40, 5, "Date expédition : ", False, 0, "C", False)

End

Public Function BasPage()

  Me.SetY(-10)
  Me.SetFont("Helvetica", "I", 8)
  Me.Cell(190, 6, "Page " & Me.PageNo() & "/{nb}" & " - " & Format$(Date(Now), "dd/mm/yyyy") & " - Impression demandée par " & User.Name, False, 0, "C", False)

End
