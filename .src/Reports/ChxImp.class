' Gambas class file

Public Sub _new()

  Dim Lig As String[]
  Dim lg As String
  Dim hfile As File

  Shell "lpstat -p >" & User.home & "/tmp/resultat 2>&1" Wait
  If Exist(User.home & "/tmp/resultat") Then
    hFile = Open User.home & "/tmp/resultat" For Read
    While Not Eof(hFile)
      Line Input #hFile, Lg
      If Not InStr(lg, "Rendering") Then
        Lig = Split(lg, " ")
        ComboBox1.Add(Lig[1])
      Endif
    Wend
  Endif

End

Public Sub Button1_Click()

  Variables.impr = ComboBox1.text
  Me.close

End
